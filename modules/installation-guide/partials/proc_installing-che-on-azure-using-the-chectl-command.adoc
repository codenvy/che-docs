// Module included in the following assemblies:
//
// installing-{prod-id-short}-on-microsoft-azure


[id="installing-{prod-id-short}-on-azure-using-the-{prod-cli}-command_{context}"]
= Installing {prod-short} on Azure using the {prod-cli} command

.Prerequisites

* The `{prod-cli}` management tool is available. See xref:using-the-chectl-management-tool.adoc[].
* The `helm` tool is available, with version 2.15 or higher. See link:https://helm.sh/[Helm].

.Procedure

* To install {prod-short}, run the following `{prod-cli}` command:
+
[subs="+attributes"]
----
$ {prod-cli} server:deploy --installer=helm --platform=k8s \                           --domain=azr.my-ide.cloud --multiuser
› Current {kubernetes} context: '{prod}'
  ✔ Verify {kubernetes} API...OK
  ✔ 👀  Looking for an already existing {prod} instance
    ✔ Verify if {prod} is deployed into {orch-namespace} "che"...it is not
  ✔ ✈️  {kubernetes} preflight checklist
    ✔ Verify if kubectl is installed
    ✔ Verify remote kubernetes status...done.
    ✔ Check {kubernetes} version: Found v1.16.10.
    ✔ Verify domain is set...set to azr.my-ide.cloud.
    ↓ Check if cluster accessible [skipped]
{prod} logs will be available in '/var/folders/tg/_5rxbhmj4xncz4szvpgswrmc0000gn/T/{prod-cli}-logs/1596019249675'
  ✔ Start following logs
    ↓ Start following Operator logs [skipped]
    ✔ Start following {prod} logs...done
    ✔ Start following Postgres logs...done
    ✔ Start following {identity-provider} logs...done
    ✔ Start following Plugin registry logs...done
    ✔ Start following Devfile registry logs...done
  ✔ Start following events
    ✔ Start following {orch-namespace} events...done
 ›   Warning: Consider using the more reliable 'OLM' installer when deploying a stable release of {prod} (--installer=olm).
  ✔ 🏃‍  Running Helm to install {prod}
    ✔ Verify if helm is installed
    ✔ Check Helm Version: Found v3.1.2+gd878d4d
    ✔ Create Namespace ({prod-namespace})...does already exist.
    ✔ Check {prod} TLS certificate...TLS certificate secret found
    ✔ Check Cluster Role Binding...does not exists.
    ✔ Preparing {prod} Helm Chart...done.
    ✔ Updating Helm Chart dependencies...done.
    ✔ Deploying {prod} Helm Chart...done.
  ✔ ✅  Post installation checklist
    ✔ PostgreSQL pod bootstrap
      ✔ scheduling...done.
      ✔ downloading images...done.
      ✔ starting...done.
    ✔ Devfile registry pod bootstrap
      ✔ scheduling...done.
      ✔ downloading images...done.
      ✔ starting...done.
    ✔ Plugin registry pod bootstrap
      ✔ scheduling...done.
      ✔ downloading images...done.
      ✔ starting...done.
    ✔ {prod} pod bootstrap
      ✔ scheduling...done.
      ✔ downloading images...done.
      ✔ starting...done.
    ✔ Retrieving {prod} server URL... https://{prod-namespace}-{prod-namespace}.azr.my-ide.cloud
    ✔ {prod} status check
  ✔ Show important messages
    ✔ Autogenerated {identity-provider} credentials are: "xxx:xxx"
Command server:deploy has completed successfully.
----

Track installation events with:
[subs="+attributes"]
----
$ kubectl get events --namespace {prod-namespace} --sort-by=.metadata.creationTimestamp
----

{identity-provider} and {prod-short} now have valid wildcard certificates.

image::installation/wildcard-certificates-for-keycloak-che.png[link="../_images/installation/wildcard-certificates-for-keycloak-che.png"]

.{prod-short} user dashboard
image::installation/che-user-dashboard.png[link="../_images/installation/che-user-dashboard.png"]
